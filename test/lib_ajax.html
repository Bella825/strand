<!doctype html>
<html>
<head>
	<meta charset="utf-8">
	<script src="../bower_components/webcomponentsjs/webcomponents.js"></script>
	<script src="../bower_components/web-component-tester/browser.js"></script>
	<script src="TestHelper.js"></script>
	<script>
		var should = chai.should();
	</script>
	<link rel="import" href="../shared/js/ajax.html"/>
</head>
<body>
<script>
describe("Ajax", function() {
	it("should exist", function() {
		StrandLib.should.be.an.object;
		StrandLib.Ajax.should.be.an.object;
	});

	it("should accept options", function() {
		var o = {something:1};
		var a = new StrandLib.Ajax(o);
		a.options.something.should.equal(1);
	});

	it("should have sensible defaults", function() {
		var a = new StrandLib.Ajax();
		a.options.should.deep.equal({
			contentType:"application/x-www-form-urlencoded",
			method:"GET",
			withCredentials:false,
			timeout:10000
		});
	});

	it("should serialize url params",function() {
		var a = new StrandLib.Ajax();
		var result = a.serializeUrl("http://www.mediamath.com",["a","b","c"]);
		result.should.equal("http://www.mediamath.com/a/b/c");

		//trailing slash
		result = a.serializeUrl("http://www.mediamath.com/",["a","b","c"]);
		result.should.equal("http://www.mediamath.com/a/b/c");

		result = a.serializeUrl("http://www.mediamath.com/",["a",12345,"c"]);
		result.should.equal("http://www.mediamath.com/a/12345/c");

	});

	it("should serialize data", function() {
		var a = new StrandLib.Ajax();
		var result = a.serialize({a:1,b:"test",c:2});
		result.should.deep.equal(["a=1", "b=test", "c=2"]);

		result = a.serialize({
			a:{b:{c:1}},
			z:10
		});
		result.should.deep.equal(["a%5Bb%5D%5Bc%5D=1","z=10"]);


	});

	it("should preflight requests via factory", function() {
		var a = new StrandLib.Ajax();
	});

});
</script>
</body>
</html>