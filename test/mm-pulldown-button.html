<!doctype html>
<html>
<head>
	<meta charset="utf-8">
	<script src="../bower_components/webcomponentsjs/webcomponents.js"></script>
	<script src="../bower_components/web-component-tester/browser.js"></script>
	<script src="TestHelper.js"></script>
	<script>
		var should = chai.should();
	</script>
	<link rel="import" href="../build/strand.html">
</head>
<body>

	<mm-pulldown-button id="pdb" type="secondary">
		<mm-icon id="icon" type="plus" width="12" height="12"></mm-icon>
		<label>Hi There</label>
		<mm-list-item>Option 1</mm-list-item>
		<mm-list-item>Option 2</mm-list-item>
		<mm-list-item>Option 3</mm-list-item>
	</mm-pulldown-button>

	<mm-pulldown-button id="pdbTruncate">
		<label>Hi There</label>
		<mm-list-item>option mm-list-item with a long name that might overflow the container</mm-list-item>
	</mm-pulldown-button>

	<mm-pulldown-button id="pdbOverflow" overflow="visible">
		<label>Hi There</label>
		<mm-list-item>option mm-list-item with a long name that might overflow the container</mm-list-item>
	</mm-pulldown-button>

	<mm-pulldown-button id="pdbFit" type="secondary">
		<label>Hi There</label>
		<mm-list-item>Option 1</mm-list-item>
	</mm-pulldown-button>

	<div style="width: 300px;">
		<mm-pulldown-button id="fit" type="secondary" fit>
			<label>Hi There</label>
			<mm-list-item>Option 1</mm-list-item>
		</mm-pulldown-button>
	</div>

	<div id="other" style="width:50px; height:50px;"></div>

	<script>

		describe("mm-pulldown-button", function() {
			
			it("should have an element constructor", function() {
				var a = new Strand.PulldownButton();
				a.nodeName.should.equal("MM-PULLDOWN-BUTTON");
			});

			it("should return icon if one was added", function() {
				var a = document.getElementById("pdb"),
					icon = document.getElementById("icon");
				icon.should.exist;
			});

			it("should toggle", function() {
				var a = document.getElementById("pdb");
				a.toggle();
				a.state.should.equal(a.STATE_OPENED);
				a.toggle();
				a.state.should.equal(a.STATE_CLOSED);
			});

			it("should set panel width correctly", function(done) {
				var overflow = document.getElementById("pdbOverflow"),
					truncate = document.getElementById("pdbTruncate");
				overflow.open();
				truncate.open();
				flush(function() {
					overflow._target.getBoundingClientRect().width.should.be.lessThan(overflow._panel.getBoundingClientRect().width);
					truncate._target.getBoundingClientRect().width.should.equal(truncate._panel.getBoundingClientRect().width);
					done();
				});
			});

		});

	</script>
</body>
</html>