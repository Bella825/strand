<!doctype html>
<html>
<head>
	<meta charset="utf-8">
	<script src="../bower_components/webcomponentsjs/webcomponents.js"></script>
	<script src="../bower_components/web-component-tester/browser.js"></script>
	<script src="TestHelper.js"></script>
	<script>
		var should = chai.should();
	</script>
	<link rel="import" href="../build/strand.html">
</head>
<body>

	<mm-spinner radius="24" inner-radius="5" line-width="10" line-weight="1.5" id="spinner" fill-color="#333333"></mm-spinner>

	<script type="text/javascript">

		describe("mm-spinner", function() {
	
			it("should have an element constructor", function() {
				var a = new Strand.Spinner();
				a.nodeName.should.equal("MM-SPINNER");
			});

			it("should set height/width based on radius", function() {
				var spinner = document.querySelector('#spinner'),
					spinnerRect = spinner.getBoundingClientRect();
				spinnerRect.height.should.equal(spinner.radius*2);
				spinnerRect.width.should.equal(spinner.radius*2);
			});

			it("should animate", function() {
				var spinner = document.querySelector('#spinner'),
					spinnerStyle = getComputedStyle(spinner.$.spinner);
				should.equal(parseFloat(spinnerStyle.animationDuration).toPrecision(5), (1/spinner.speed).toPrecision(5));
				should.equal(spinnerStyle.animationTimingFunction, 'steps('+spinner.numTicks+', end)');
			});

			it("should stop the animation", function(done) {
				var spinner = document.querySelector('#spinner'),
					spinnerStyle = function() { return getComputedStyle(spinner.$.spinner); }
				spinner.stop();
				flush(function() {
					spinnerStyle().animationPlayState.should.equal('paused');
					done();
				});
			});

			it("should restart the animation", function(done) {
				var spinner = document.querySelector('#spinner'),
					spinnerStyle = function() { return getComputedStyle(spinner.$.spinner); }
				spinner.start();
				flush(function() {
					spinnerStyle().animationPlayState.should.equal('running');
					done();
				});
			});

		});
		
	</script>

</body>
</html>