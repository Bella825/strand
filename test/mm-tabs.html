<!doctype html>
<html>
<head>
	<meta charset="utf-8">
	<script src="../bower_components/webcomponentsjs/webcomponents.js"></script>
	<script src="../bower_components/web-component-tester/browser.js"></script>
	<script src="TestHelper.js"></script>
	<script>
		var should = chai.should();
	</script>
	<link rel="import" href="../build/mm-tab/mm-tab.html">
	<link rel="import" href="../build/mm-tabs/mm-tabs.html">
	<script>
		describe("mm-tabs", function() {
			
			it("should have an element constructor", function() {
				var a = new Strand.Tabs();
				a.nodeName.should.equal("MM-TABS");
			});

			it("should collect tabs", function() {
				var a = document.querySelector('#default');
				a.tabs.should.not.be.empty;
			});

			it("should set the active tab", function() {
				var a = document.querySelector('#default');
				a.$.selector.selected.should.equal(a.querySelector('mm-tab[active]'));
				var b = document.querySelector('#allActive');
				b.$.selector.selected.should.equal(b.querySelector('mm-tab[active]'));
				var c = document.querySelector('#testTabs');
				c.$.selector.selected.should.equal(c.querySelector('mm-tab[active]'));
			});

		});

		describe("mm-tab", function() {
			it("should have an element constructor", function() {
				var a = new Strand.Tab();
				a.nodeName.should.equal("MM-TAB");
			});

			it("should fire a `loaded` event", function(done) {
				var a = document.querySelector('#testTab1');
				a.addEventListener('loaded', function(detail) {
					done();
				});
				a.active = true;
			});

			// it("should load external content and fire an event", function(done) {
			// 	var a = document.querySelector('#testTab3');
			// 	a.addEventListener('loaded', function(detail) {
			// 		var tmpl = detail.target.querySelector('template');
			// 		tmpl.addEventListener('dom-change', function(e) {
			// 			e.target.$.aux.should.exist;
			// 			done();
			// 		});
			// 	});
			// 	a.active = true;
			// });

			it("should load external content imperatively and have a callback", function(done) {
				var a = document.querySelector('#testTab2');
				a.loadExternal('test-mm-tabs-aux.htm', function() {
					var ext = a.querySelector('template');
					ext.should.exist;
					done();
				});
				a.active = true;
			});
		})
	</script>
</head>
<body>

	<mm-tabs id="default">
		<mm-tab></mm-tab>
		<mm-tab></mm-tab>
		<mm-tab></mm-tab>
	</mm-tabs>

	<mm-tabs id="allActive">
		<mm-tab active></mm-tab>
		<mm-tab active></mm-tab>
		<mm-tab active></mm-tab>
	</mm-tabs>

	<mm-tabs id="testTabs">
		<mm-tab tab-label="First" url="test-mm-tabs-aux.htm" id="testTab" active></mm-tab>
		<mm-tab tab-label="Second" url="test-mm-tabs-aux.htm" id="testTab1"></mm-tab>
		<mm-tab tab-label="Between Second and Third" url="test-mm-tabs-aux.htm" id="testTab3"></mm-tab>
		<mm-tab tab-label="Third" id="testTab2"></mm-tab>
	</mm-tabs>

</body>
</html>